/* automatically generated by JSCoverage - do not edit */
if (typeof _$jscoverage === 'undefined') _$jscoverage = {};
if (! _$jscoverage['event-creator.js']) {
  _$jscoverage['event-creator.js'] = [];
  _$jscoverage['event-creator.js'][1] = 0;
  _$jscoverage['event-creator.js'][2] = 0;
  _$jscoverage['event-creator.js'][3] = 0;
  _$jscoverage['event-creator.js'][4] = 0;
  _$jscoverage['event-creator.js'][5] = 0;
  _$jscoverage['event-creator.js'][6] = 0;
  _$jscoverage['event-creator.js'][8] = 0;
  _$jscoverage['event-creator.js'][9] = 0;
  _$jscoverage['event-creator.js'][10] = 0;
  _$jscoverage['event-creator.js'][11] = 0;
  _$jscoverage['event-creator.js'][12] = 0;
  _$jscoverage['event-creator.js'][13] = 0;
  _$jscoverage['event-creator.js'][14] = 0;
  _$jscoverage['event-creator.js'][15] = 0;
  _$jscoverage['event-creator.js'][17] = 0;
  _$jscoverage['event-creator.js'][18] = 0;
  _$jscoverage['event-creator.js'][20] = 0;
  _$jscoverage['event-creator.js'][21] = 0;
  _$jscoverage['event-creator.js'][23] = 0;
  _$jscoverage['event-creator.js'][24] = 0;
  _$jscoverage['event-creator.js'][26] = 0;
  _$jscoverage['event-creator.js'][27] = 0;
  _$jscoverage['event-creator.js'][29] = 0;
  _$jscoverage['event-creator.js'][30] = 0;
  _$jscoverage['event-creator.js'][32] = 0;
  _$jscoverage['event-creator.js'][33] = 0;
  _$jscoverage['event-creator.js'][34] = 0;
  _$jscoverage['event-creator.js'][35] = 0;
  _$jscoverage['event-creator.js'][37] = 0;
  _$jscoverage['event-creator.js'][39] = 0;
  _$jscoverage['event-creator.js'][40] = 0;
  _$jscoverage['event-creator.js'][41] = 0;
  _$jscoverage['event-creator.js'][42] = 0;
  _$jscoverage['event-creator.js'][43] = 0;
  _$jscoverage['event-creator.js'][44] = 0;
  _$jscoverage['event-creator.js'][46] = 0;
  _$jscoverage['event-creator.js'][47] = 0;
  _$jscoverage['event-creator.js'][51] = 0;
  _$jscoverage['event-creator.js'][52] = 0;
  _$jscoverage['event-creator.js'][53] = 0;
  _$jscoverage['event-creator.js'][54] = 0;
  _$jscoverage['event-creator.js'][55] = 0;
  _$jscoverage['event-creator.js'][56] = 0;
  _$jscoverage['event-creator.js'][57] = 0;
  _$jscoverage['event-creator.js'][58] = 0;
  _$jscoverage['event-creator.js'][59] = 0;
  _$jscoverage['event-creator.js'][60] = 0;
  _$jscoverage['event-creator.js'][61] = 0;
  _$jscoverage['event-creator.js'][62] = 0;
  _$jscoverage['event-creator.js'][64] = 0;
  _$jscoverage['event-creator.js'][65] = 0;
  _$jscoverage['event-creator.js'][69] = 0;
  _$jscoverage['event-creator.js'][70] = 0;
  _$jscoverage['event-creator.js'][73] = 0;
  _$jscoverage['event-creator.js'][74] = 0;
  _$jscoverage['event-creator.js'][75] = 0;
  _$jscoverage['event-creator.js'][76] = 0;
  _$jscoverage['event-creator.js'][77] = 0;
  _$jscoverage['event-creator.js'][78] = 0;
  _$jscoverage['event-creator.js'][79] = 0;
  _$jscoverage['event-creator.js'][80] = 0;
  _$jscoverage['event-creator.js'][81] = 0;
  _$jscoverage['event-creator.js'][82] = 0;
  _$jscoverage['event-creator.js'][83] = 0;
  _$jscoverage['event-creator.js'][84] = 0;
  _$jscoverage['event-creator.js'][85] = 0;
  _$jscoverage['event-creator.js'][89] = 0;
  _$jscoverage['event-creator.js'][90] = 0;
  _$jscoverage['event-creator.js'][93] = 0;
  _$jscoverage['event-creator.js'][94] = 0;
  _$jscoverage['event-creator.js'][95] = 0;
  _$jscoverage['event-creator.js'][96] = 0;
  _$jscoverage['event-creator.js'][97] = 0;
  _$jscoverage['event-creator.js'][98] = 0;
  _$jscoverage['event-creator.js'][99] = 0;
  _$jscoverage['event-creator.js'][100] = 0;
  _$jscoverage['event-creator.js'][101] = 0;
  _$jscoverage['event-creator.js'][103] = 0;
  _$jscoverage['event-creator.js'][104] = 0;
  _$jscoverage['event-creator.js'][107] = 0;
  _$jscoverage['event-creator.js'][108] = 0;
  _$jscoverage['event-creator.js'][110] = 0;
  _$jscoverage['event-creator.js'][111] = 0;
  _$jscoverage['event-creator.js'][116] = 0;
  _$jscoverage['event-creator.js'][117] = 0;
  _$jscoverage['event-creator.js'][120] = 0;
  _$jscoverage['event-creator.js'][124] = 0;
  _$jscoverage['event-creator.js'][134] = 0;
  _$jscoverage['event-creator.js'][135] = 0;
  _$jscoverage['event-creator.js'][136] = 0;
  _$jscoverage['event-creator.js'][137] = 0;
  _$jscoverage['event-creator.js'][138] = 0;
  _$jscoverage['event-creator.js'][139] = 0;
  _$jscoverage['event-creator.js'][141] = 0;
  _$jscoverage['event-creator.js'][142] = 0;
  _$jscoverage['event-creator.js'][144] = 0;
  _$jscoverage['event-creator.js'][145] = 0;
  _$jscoverage['event-creator.js'][146] = 0;
  _$jscoverage['event-creator.js'][147] = 0;
  _$jscoverage['event-creator.js'][148] = 0;
  _$jscoverage['event-creator.js'][149] = 0;
  _$jscoverage['event-creator.js'][150] = 0;
  _$jscoverage['event-creator.js'][151] = 0;
  _$jscoverage['event-creator.js'][152] = 0;
  _$jscoverage['event-creator.js'][153] = 0;
  _$jscoverage['event-creator.js'][154] = 0;
  _$jscoverage['event-creator.js'][155] = 0;
  _$jscoverage['event-creator.js'][157] = 0;
  _$jscoverage['event-creator.js'][158] = 0;
  _$jscoverage['event-creator.js'][162] = 0;
  _$jscoverage['event-creator.js'][163] = 0;
  _$jscoverage['event-creator.js'][166] = 0;
  _$jscoverage['event-creator.js'][167] = 0;
  _$jscoverage['event-creator.js'][168] = 0;
  _$jscoverage['event-creator.js'][169] = 0;
  _$jscoverage['event-creator.js'][170] = 0;
  _$jscoverage['event-creator.js'][171] = 0;
  _$jscoverage['event-creator.js'][172] = 0;
  _$jscoverage['event-creator.js'][173] = 0;
  _$jscoverage['event-creator.js'][174] = 0;
  _$jscoverage['event-creator.js'][175] = 0;
  _$jscoverage['event-creator.js'][176] = 0;
  _$jscoverage['event-creator.js'][177] = 0;
  _$jscoverage['event-creator.js'][178] = 0;
  _$jscoverage['event-creator.js'][180] = 0;
  _$jscoverage['event-creator.js'][181] = 0;
  _$jscoverage['event-creator.js'][182] = 0;
  _$jscoverage['event-creator.js'][186] = 0;
  _$jscoverage['event-creator.js'][187] = 0;
  _$jscoverage['event-creator.js'][190] = 0;
  _$jscoverage['event-creator.js'][191] = 0;
  _$jscoverage['event-creator.js'][192] = 0;
  _$jscoverage['event-creator.js'][193] = 0;
  _$jscoverage['event-creator.js'][194] = 0;
  _$jscoverage['event-creator.js'][195] = 0;
  _$jscoverage['event-creator.js'][196] = 0;
  _$jscoverage['event-creator.js'][197] = 0;
  _$jscoverage['event-creator.js'][198] = 0;
  _$jscoverage['event-creator.js'][199] = 0;
  _$jscoverage['event-creator.js'][200] = 0;
  _$jscoverage['event-creator.js'][202] = 0;
  _$jscoverage['event-creator.js'][203] = 0;
  _$jscoverage['event-creator.js'][206] = 0;
  _$jscoverage['event-creator.js'][207] = 0;
  _$jscoverage['event-creator.js'][209] = 0;
  _$jscoverage['event-creator.js'][210] = 0;
  _$jscoverage['event-creator.js'][215] = 0;
  _$jscoverage['event-creator.js'][216] = 0;
  _$jscoverage['event-creator.js'][219] = 0;
  _$jscoverage['event-creator.js'][220] = 0;
  _$jscoverage['event-creator.js'][229] = 0;
  _$jscoverage['event-creator.js'][230] = 0;
  _$jscoverage['event-creator.js'][231] = 0;
  _$jscoverage['event-creator.js'][232] = 0;
  _$jscoverage['event-creator.js'][234] = 0;
  _$jscoverage['event-creator.js'][235] = 0;
  _$jscoverage['event-creator.js'][236] = 0;
  _$jscoverage['event-creator.js'][237] = 0;
  _$jscoverage['event-creator.js'][238] = 0;
  _$jscoverage['event-creator.js'][239] = 0;
  _$jscoverage['event-creator.js'][240] = 0;
  _$jscoverage['event-creator.js'][241] = 0;
  _$jscoverage['event-creator.js'][242] = 0;
  _$jscoverage['event-creator.js'][243] = 0;
  _$jscoverage['event-creator.js'][244] = 0;
  _$jscoverage['event-creator.js'][245] = 0;
  _$jscoverage['event-creator.js'][246] = 0;
  _$jscoverage['event-creator.js'][247] = 0;
  _$jscoverage['event-creator.js'][249] = 0;
  _$jscoverage['event-creator.js'][250] = 0;
  _$jscoverage['event-creator.js'][251] = 0;
  _$jscoverage['event-creator.js'][255] = 0;
  _$jscoverage['event-creator.js'][256] = 0;
  _$jscoverage['event-creator.js'][257] = 0;
  _$jscoverage['event-creator.js'][258] = 0;
  _$jscoverage['event-creator.js'][259] = 0;
  _$jscoverage['event-creator.js'][260] = 0;
  _$jscoverage['event-creator.js'][261] = 0;
  _$jscoverage['event-creator.js'][262] = 0;
  _$jscoverage['event-creator.js'][263] = 0;
  _$jscoverage['event-creator.js'][264] = 0;
  _$jscoverage['event-creator.js'][265] = 0;
  _$jscoverage['event-creator.js'][266] = 0;
  _$jscoverage['event-creator.js'][267] = 0;
  _$jscoverage['event-creator.js'][268] = 0;
  _$jscoverage['event-creator.js'][269] = 0;
  _$jscoverage['event-creator.js'][270] = 0;
  _$jscoverage['event-creator.js'][271] = 0;
  _$jscoverage['event-creator.js'][272] = 0;
  _$jscoverage['event-creator.js'][274] = 0;
  _$jscoverage['event-creator.js'][275] = 0;
  _$jscoverage['event-creator.js'][278] = 0;
  _$jscoverage['event-creator.js'][279] = 0;
  _$jscoverage['event-creator.js'][280] = 0;
  _$jscoverage['event-creator.js'][281] = 0;
  _$jscoverage['event-creator.js'][282] = 0;
  _$jscoverage['event-creator.js'][283] = 0;
  _$jscoverage['event-creator.js'][284] = 0;
  _$jscoverage['event-creator.js'][286] = 0;
  _$jscoverage['event-creator.js'][287] = 0;
  _$jscoverage['event-creator.js'][291] = 0;
  _$jscoverage['event-creator.js'][292] = 0;
  _$jscoverage['event-creator.js'][295] = 0;
  _$jscoverage['event-creator.js'][296] = 0;
  _$jscoverage['event-creator.js'][297] = 0;
  _$jscoverage['event-creator.js'][298] = 0;
  _$jscoverage['event-creator.js'][299] = 0;
  _$jscoverage['event-creator.js'][301] = 0;
  _$jscoverage['event-creator.js'][302] = 0;
  _$jscoverage['event-creator.js'][303] = 0;
  _$jscoverage['event-creator.js'][304] = 0;
  _$jscoverage['event-creator.js'][306] = 0;
  _$jscoverage['event-creator.js'][307] = 0;
  _$jscoverage['event-creator.js'][308] = 0;
  _$jscoverage['event-creator.js'][309] = 0;
  _$jscoverage['event-creator.js'][310] = 0;
  _$jscoverage['event-creator.js'][311] = 0;
  _$jscoverage['event-creator.js'][312] = 0;
  _$jscoverage['event-creator.js'][313] = 0;
  _$jscoverage['event-creator.js'][314] = 0;
  _$jscoverage['event-creator.js'][315] = 0;
  _$jscoverage['event-creator.js'][316] = 0;
  _$jscoverage['event-creator.js'][317] = 0;
  _$jscoverage['event-creator.js'][318] = 0;
  _$jscoverage['event-creator.js'][319] = 0;
  _$jscoverage['event-creator.js'][320] = 0;
  _$jscoverage['event-creator.js'][321] = 0;
  _$jscoverage['event-creator.js'][323] = 0;
  _$jscoverage['event-creator.js'][324] = 0;
  _$jscoverage['event-creator.js'][327] = 0;
  _$jscoverage['event-creator.js'][328] = 0;
  _$jscoverage['event-creator.js'][330] = 0;
  _$jscoverage['event-creator.js'][331] = 0;
  _$jscoverage['event-creator.js'][334] = 0;
  _$jscoverage['event-creator.js'][335] = 0;
  _$jscoverage['event-creator.js'][337] = 0;
  _$jscoverage['event-creator.js'][338] = 0;
  _$jscoverage['event-creator.js'][340] = 0;
  _$jscoverage['event-creator.js'][341] = 0;
  _$jscoverage['event-creator.js'][344] = 0;
  _$jscoverage['event-creator.js'][345] = 0;
  _$jscoverage['event-creator.js'][346] = 0;
  _$jscoverage['event-creator.js'][347] = 0;
  _$jscoverage['event-creator.js'][348] = 0;
  _$jscoverage['event-creator.js'][349] = 0;
  _$jscoverage['event-creator.js'][350] = 0;
  _$jscoverage['event-creator.js'][353] = 0;
  _$jscoverage['event-creator.js'][354] = 0;
  _$jscoverage['event-creator.js'][355] = 0;
  _$jscoverage['event-creator.js'][358] = 0;
  _$jscoverage['event-creator.js'][359] = 0;
  _$jscoverage['event-creator.js'][360] = 0;
  _$jscoverage['event-creator.js'][361] = 0;
  _$jscoverage['event-creator.js'][363] = 0;
  _$jscoverage['event-creator.js'][364] = 0;
  _$jscoverage['event-creator.js'][367] = 0;
  _$jscoverage['event-creator.js'][368] = 0;
  _$jscoverage['event-creator.js'][369] = 0;
  _$jscoverage['event-creator.js'][370] = 0;
  _$jscoverage['event-creator.js'][371] = 0;
  _$jscoverage['event-creator.js'][372] = 0;
  _$jscoverage['event-creator.js'][373] = 0;
  _$jscoverage['event-creator.js'][374] = 0;
  _$jscoverage['event-creator.js'][375] = 0;
  _$jscoverage['event-creator.js'][376] = 0;
  _$jscoverage['event-creator.js'][378] = 0;
  _$jscoverage['event-creator.js'][379] = 0;
  _$jscoverage['event-creator.js'][380] = 0;
  _$jscoverage['event-creator.js'][382] = 0;
  _$jscoverage['event-creator.js'][383] = 0;
  _$jscoverage['event-creator.js'][385] = 0;
  _$jscoverage['event-creator.js'][386] = 0;
  _$jscoverage['event-creator.js'][387] = 0;
  _$jscoverage['event-creator.js'][389] = 0;
  _$jscoverage['event-creator.js'][390] = 0;
  _$jscoverage['event-creator.js'][393] = 0;
  _$jscoverage['event-creator.js'][395] = 0;
  _$jscoverage['event-creator.js'][396] = 0;
  _$jscoverage['event-creator.js'][399] = 0;
  _$jscoverage['event-creator.js'][401] = 0;
  _$jscoverage['event-creator.js'][402] = 0;
  _$jscoverage['event-creator.js'][403] = 0;
  _$jscoverage['event-creator.js'][405] = 0;
  _$jscoverage['event-creator.js'][406] = 0;
  _$jscoverage['event-creator.js'][407] = 0;
  _$jscoverage['event-creator.js'][408] = 0;
}
_$jscoverage['event-creator.js'][1]++;
(function () {
  _$jscoverage['event-creator.js'][2]++;
  MKT.EventCreator = (function (eventLoader, colourMap, config) {
  _$jscoverage['event-creator.js'][3]++;
  this.eventLoader = eventLoader;
  _$jscoverage['event-creator.js'][4]++;
  this.colourMap = colourMap;
  _$jscoverage['event-creator.js'][5]++;
  this.config = config;
  _$jscoverage['event-creator.js'][6]++;
  return this;
});
  _$jscoverage['event-creator.js'][8]++;
  MKT.EventCreator.prototype.create = (function (event) {
  _$jscoverage['event-creator.js'][9]++;
  var eventDOM;
  _$jscoverage['event-creator.js'][10]++;
  eventDOM = $("#templates .event").clone();
  _$jscoverage['event-creator.js'][11]++;
  eventDOM.data("event", event);
  _$jscoverage['event-creator.js'][12]++;
  $(".text", eventDOM).text(event.summary);
  _$jscoverage['event-creator.js'][13]++;
  eventDOM.width((event.weekLength * 14.2857) + "%");
  _$jscoverage['event-creator.js'][14]++;
  if (! (event.isStart && event.isEnd)) {
    _$jscoverage['event-creator.js'][15]++;
    eventDOM.addClass("multi-week");
  }
  _$jscoverage['event-creator.js'][17]++;
  if (event.isStart) {
    _$jscoverage['event-creator.js'][18]++;
    eventDOM.addClass("start");
  }
  _$jscoverage['event-creator.js'][20]++;
  if (event.isEnd) {
    _$jscoverage['event-creator.js'][21]++;
    eventDOM.addClass("end");
  }
  _$jscoverage['event-creator.js'][23]++;
  if (event.summary.endsWith("?")) {
    _$jscoverage['event-creator.js'][24]++;
    eventDOM.addClass("tentative");
  }
  _$jscoverage['event-creator.js'][26]++;
  if (event.summary.endsWith("!")) {
    _$jscoverage['event-creator.js'][27]++;
    eventDOM.addClass("important");
  }
  _$jscoverage['event-creator.js'][29]++;
  if (event.isNew) {
    _$jscoverage['event-creator.js'][30]++;
    eventDOM.addClass("new");
  }
  _$jscoverage['event-creator.js'][32]++;
  event.eventDOM = eventDOM;
  _$jscoverage['event-creator.js'][33]++;
  this.setColour(event, event.calNumber);
  _$jscoverage['event-creator.js'][34]++;
  if (event.editable) {
    _$jscoverage['event-creator.js'][35]++;
    this.makeEditable(event);
  }
  _$jscoverage['event-creator.js'][37]++;
  return eventDOM;
});
  _$jscoverage['event-creator.js'][39]++;
  MKT.EventCreator.prototype.makeEditable = (function (event) {
  _$jscoverage['event-creator.js'][40]++;
  this.makeDraggable(event);
  _$jscoverage['event-creator.js'][41]++;
  this.makeResizable(event);
  _$jscoverage['event-creator.js'][42]++;
  return event.eventDOM.click((function (__this) {
  _$jscoverage['event-creator.js'][43]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][44]++;
  return this.click(event);
});
  _$jscoverage['event-creator.js'][46]++;
  return (function () {
  _$jscoverage['event-creator.js'][47]++;
  return __func.apply(__this, arguments);
});
})(this));
});
  _$jscoverage['event-creator.js'][51]++;
  MKT.EventCreator.prototype.makeDraggable = (function (event) {
  _$jscoverage['event-creator.js'][52]++;
  var do_drag, do_drag_stop, do_start_drag, dragging;
  _$jscoverage['event-creator.js'][53]++;
  dragging = {};
  _$jscoverage['event-creator.js'][54]++;
  do_start_drag = (function (__this) {
  _$jscoverage['event-creator.js'][55]++;
  var __func = (function (ev, ui) {
  _$jscoverage['event-creator.js'][56]++;
  dragging.start = event.start;
  _$jscoverage['event-creator.js'][57]++;
  dragging.end = event.end;
  _$jscoverage['event-creator.js'][58]++;
  dragging.day = null;
  _$jscoverage['event-creator.js'][59]++;
  return $("#body").mousemove((function (__this) {
  _$jscoverage['event-creator.js'][60]++;
  var __func = (function (e) {
  _$jscoverage['event-creator.js'][61]++;
  dragging.day = $(e.target).parents(".day").add(e.target);
  _$jscoverage['event-creator.js'][62]++;
  return dragging.day;
});
  _$jscoverage['event-creator.js'][64]++;
  return (function () {
  _$jscoverage['event-creator.js'][65]++;
  return __func.apply(__this, arguments);
});
})(this));
});
  _$jscoverage['event-creator.js'][69]++;
  return (function () {
  _$jscoverage['event-creator.js'][70]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][73]++;
  do_drag = (function (__this) {
  _$jscoverage['event-creator.js'][74]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][75]++;
  var date, dateString, id, oldEnd, oldStart;
  _$jscoverage['event-creator.js'][76]++;
  if (dragging.day) {
    _$jscoverage['event-creator.js'][77]++;
    id = dragging.day.attr("id");
    _$jscoverage['event-creator.js'][78]++;
    dateString = id.substring(this.config.dayIdPrefix.length);
    _$jscoverage['event-creator.js'][79]++;
    date = Date.parseYMD(dateString);
    _$jscoverage['event-creator.js'][80]++;
    oldStart = event.start;
    _$jscoverage['event-creator.js'][81]++;
    oldEnd = event.end;
    _$jscoverage['event-creator.js'][82]++;
    event.start = date;
    _$jscoverage['event-creator.js'][83]++;
    event.end = date.addDays(event.length);
    _$jscoverage['event-creator.js'][84]++;
    if (event.start - oldStart !== 0 || event.end - oldEnd !== 0) {
      _$jscoverage['event-creator.js'][85]++;
      return this.eventLoader.updateEvent(event, oldStart, oldEnd);
    }
  }
});
  _$jscoverage['event-creator.js'][89]++;
  return (function () {
  _$jscoverage['event-creator.js'][90]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][93]++;
  do_drag_stop = (function (__this) {
  _$jscoverage['event-creator.js'][94]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][95]++;
  $("#body").unbind("mousemove");
  _$jscoverage['event-creator.js'][96]++;
  if (event.start - dragging.start !== 0 || event.end - dragging.end !== 0) {
    _$jscoverage['event-creator.js'][97]++;
    event.eventDOM.addClass("updating");
    _$jscoverage['event-creator.js'][98]++;
    return event.save((function (__this) {
  _$jscoverage['event-creator.js'][99]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][100]++;
  console.log("Moved event", arguments);
  _$jscoverage['event-creator.js'][101]++;
  return event.eventDOM.removeClass("updating");
});
  _$jscoverage['event-creator.js'][103]++;
  return (function () {
  _$jscoverage['event-creator.js'][104]++;
  return __func.apply(__this, arguments);
});
})(this), (function (__this) {
  _$jscoverage['event-creator.js'][107]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][108]++;
  return console.log("Failed to move event :(", arguments, event.eventDOM.removeClass("updating"), event.eventDOM.addClass("error"));
});
  _$jscoverage['event-creator.js'][110]++;
  return (function () {
  _$jscoverage['event-creator.js'][111]++;
  return __func.apply(__this, arguments);
});
})(this));
  }
});
  _$jscoverage['event-creator.js'][116]++;
  return (function () {
  _$jscoverage['event-creator.js'][117]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][120]++;
  return event.eventDOM.draggable({revert: true, distance: 10, helper: (function () {
  _$jscoverage['event-creator.js'][124]++;
  return $("<div>");
}), scroll: false, cursor: "move", handle: $(".text", event.eventDOM), start: do_start_drag, drag: do_drag, stop: do_drag_stop});
});
  _$jscoverage['event-creator.js'][134]++;
  MKT.EventCreator.prototype.makeResizable = (function (event) {
  _$jscoverage['event-creator.js'][135]++;
  var do_resize, do_resize_start, do_resize_stop, handles, resizing;
  _$jscoverage['event-creator.js'][136]++;
  resizing = {};
  _$jscoverage['event-creator.js'][137]++;
  handles = [];
  _$jscoverage['event-creator.js'][138]++;
  if (event.isStart) {
    _$jscoverage['event-creator.js'][139]++;
    handles.push("w");
  }
  _$jscoverage['event-creator.js'][141]++;
  if (event.isEnd) {
    _$jscoverage['event-creator.js'][142]++;
    handles.push("e");
  }
  _$jscoverage['event-creator.js'][144]++;
  do_resize_start = (function (__this) {
  _$jscoverage['event-creator.js'][145]++;
  var __func = (function (e, ui) {
  _$jscoverage['event-creator.js'][146]++;
  resizing.direction = (e.pageX < (ui.originalPosition.left + (ui.originalSize.width / 2)))? "start": "end";
  _$jscoverage['event-creator.js'][147]++;
  resizing.x = e.pageX;
  _$jscoverage['event-creator.js'][148]++;
  resizing.y = e.pageY;
  _$jscoverage['event-creator.js'][149]++;
  resizing.start = event.start;
  _$jscoverage['event-creator.js'][150]++;
  resizing.end = event.end;
  _$jscoverage['event-creator.js'][151]++;
  resizing.day = null;
  _$jscoverage['event-creator.js'][152]++;
  return $("#body").mousemove((function (__this) {
  _$jscoverage['event-creator.js'][153]++;
  var __func = (function (e) {
  _$jscoverage['event-creator.js'][154]++;
  resizing.day = $(e.target).parents(".day").add(e.target);
  _$jscoverage['event-creator.js'][155]++;
  return resizing.day;
});
  _$jscoverage['event-creator.js'][157]++;
  return (function () {
  _$jscoverage['event-creator.js'][158]++;
  return __func.apply(__this, arguments);
});
})(this));
});
  _$jscoverage['event-creator.js'][162]++;
  return (function () {
  _$jscoverage['event-creator.js'][163]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][166]++;
  do_resize = (function (__this) {
  _$jscoverage['event-creator.js'][167]++;
  var __func = (function (e, ui) {
  _$jscoverage['event-creator.js'][168]++;
  var date, dateString, id, oldEnd, oldStart;
  _$jscoverage['event-creator.js'][169]++;
  if (resizing.day) {
    _$jscoverage['event-creator.js'][170]++;
    id = resizing.day.attr("id");
    _$jscoverage['event-creator.js'][171]++;
    dateString = id.substring(this.config.dayIdPrefix.length);
    _$jscoverage['event-creator.js'][172]++;
    date = Date.parseYMD(dateString);
    _$jscoverage['event-creator.js'][173]++;
    oldStart = event.start;
    _$jscoverage['event-creator.js'][174]++;
    oldEnd = event.end;
    _$jscoverage['event-creator.js'][175]++;
    if (resizing.direction === "start") {
      _$jscoverage['event-creator.js'][176]++;
      event.start = date < resizing.end? date: resizing.end.addDays(-1);
    }
    else {
      _$jscoverage['event-creator.js'][177]++;
      if (resizing.direction === "end") {
        _$jscoverage['event-creator.js'][178]++;
        event.end = date > resizing.start? date.addDays(1): resizing.start.addDays(1);
      }
    }
    _$jscoverage['event-creator.js'][180]++;
    event.length = Math.round((event.end - event.start) / (86400000));
    _$jscoverage['event-creator.js'][181]++;
    if (event.start - oldStart !== 0 || event.end - oldEnd !== 0) {
      _$jscoverage['event-creator.js'][182]++;
      return this.eventLoader.updateEvent(event, oldStart, oldEnd);
    }
  }
});
  _$jscoverage['event-creator.js'][186]++;
  return (function () {
  _$jscoverage['event-creator.js'][187]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][190]++;
  do_resize_stop = (function (__this) {
  _$jscoverage['event-creator.js'][191]++;
  var __func = (function (e, ui) {
  _$jscoverage['event-creator.js'][192]++;
  $("#body").unbind("mousemove");
  _$jscoverage['event-creator.js'][193]++;
  event.eventDOM.remove();
  _$jscoverage['event-creator.js'][194]++;
  this.eventLoader.updateEvent(event);
  _$jscoverage['event-creator.js'][195]++;
  event.eventDOM.addClass("updating");
  _$jscoverage['event-creator.js'][196]++;
  if (event.start - resizing.start !== 0 || event.end - resizing.end !== 0) {
    _$jscoverage['event-creator.js'][197]++;
    return event.save((function (__this) {
  _$jscoverage['event-creator.js'][198]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][199]++;
  console.log("Resized event", arguments);
  _$jscoverage['event-creator.js'][200]++;
  return event.eventDOM.removeClass("updating");
});
  _$jscoverage['event-creator.js'][202]++;
  return (function () {
  _$jscoverage['event-creator.js'][203]++;
  return __func.apply(__this, arguments);
});
})(this), (function (__this) {
  _$jscoverage['event-creator.js'][206]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][207]++;
  return console.log("Failed to resize event :(", arguments, event.eventDOM.removeClass("updating"), event.eventDOM.addClass("error"));
});
  _$jscoverage['event-creator.js'][209]++;
  return (function () {
  _$jscoverage['event-creator.js'][210]++;
  return __func.apply(__this, arguments);
});
})(this));
  }
});
  _$jscoverage['event-creator.js'][215]++;
  return (function () {
  _$jscoverage['event-creator.js'][216]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][219]++;
  if (event.isStart || event.isEnd) {
    _$jscoverage['event-creator.js'][220]++;
    return event.eventDOM.resizable({handles: handles.join(", "), ghost: true, start: do_resize_start, resize: do_resize, stop: do_resize_stop});
  }
});
  _$jscoverage['event-creator.js'][229]++;
  MKT.EventCreator.prototype.click = (function (event) {
  _$jscoverage['event-creator.js'][230]++;
  var calendarPicker, delButton, deleteEvent, editor, parent, removeEditor, startCalNumber, startText, top;
  _$jscoverage['event-creator.js'][231]++;
  if (event.eventDOM.hasClass("editing")) {
    _$jscoverage['event-creator.js'][232]++;
    return null;
  }
  _$jscoverage['event-creator.js'][234]++;
  editor = $("#templates .editor").clone();
  _$jscoverage['event-creator.js'][235]++;
  delButton = $("#templates .delete").clone();
  _$jscoverage['event-creator.js'][236]++;
  calendarPicker = this.getCalendarPicker(event);
  _$jscoverage['event-creator.js'][237]++;
  startText = $(".text", event.eventDOM).text();
  _$jscoverage['event-creator.js'][238]++;
  startCalNumber = event.calNumber;
  _$jscoverage['event-creator.js'][239]++;
  $("textarea", editor).text(event.isNew? "New event...": startText);
  _$jscoverage['event-creator.js'][240]++;
  $("textarea", editor).height($(".text", event.eventDOM).height());
  _$jscoverage['event-creator.js'][241]++;
  $("textarea", editor).keyup((function () {
  _$jscoverage['event-creator.js'][242]++;
  var height, text;
  _$jscoverage['event-creator.js'][243]++;
  text = $("textarea", editor).val();
  _$jscoverage['event-creator.js'][244]++;
  $("#layout-event").width((event.weekLength * 14.2857) + "%");
  _$jscoverage['event-creator.js'][245]++;
  height = $("#layout-event .text").text(text).outerHeight();
  _$jscoverage['event-creator.js'][246]++;
  $("textarea", editor).height(height);
  _$jscoverage['event-creator.js'][247]++;
  return event.eventDOM.css("border", "none");
})).keyup();
  _$jscoverage['event-creator.js'][249]++;
  parent = event.eventDOM.parent();
  _$jscoverage['event-creator.js'][250]++;
  top = event.eventDOM.css("top");
  _$jscoverage['event-creator.js'][251]++;
  event.eventDOM.css({top: event.eventDOM.offset().top, left: event.eventDOM.offset().left});
  _$jscoverage['event-creator.js'][255]++;
  event.eventDOM.appendTo($("body"));
  _$jscoverage['event-creator.js'][256]++;
  $(".text", event.eventDOM).hide();
  _$jscoverage['event-creator.js'][257]++;
  $(".inner", event.eventDOM).append(editor);
  _$jscoverage['event-creator.js'][258]++;
  delButton.appendTo(event.eventDOM).hide().fadeIn();
  _$jscoverage['event-creator.js'][259]++;
  calendarPicker.appendTo(event.eventDOM).hide().fadeIn();
  _$jscoverage['event-creator.js'][260]++;
  $("textarea", editor).focus().select();
  _$jscoverage['event-creator.js'][261]++;
  event.eventDOM.addClass("editing");
  _$jscoverage['event-creator.js'][262]++;
  event.eventDOM.removeClass("error");
  _$jscoverage['event-creator.js'][263]++;
  deleteEvent = (function (__this) {
  _$jscoverage['event-creator.js'][264]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][265]++;
  event.isDeleting = true;
  _$jscoverage['event-creator.js'][266]++;
  removeEditor();
  _$jscoverage['event-creator.js'][267]++;
  event.eventDOM.addClass("updating");
  _$jscoverage['event-creator.js'][268]++;
  event.eventDOM.addClass("deleting");
  _$jscoverage['event-creator.js'][269]++;
  return event.remove((function (__this) {
  _$jscoverage['event-creator.js'][270]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][271]++;
  console.log("Deleted event", arguments);
  _$jscoverage['event-creator.js'][272]++;
  return event.eventDOM.remove();
});
  _$jscoverage['event-creator.js'][274]++;
  return (function () {
  _$jscoverage['event-creator.js'][275]++;
  return __func.apply(__this, arguments);
});
})(this), (function (__this) {
  _$jscoverage['event-creator.js'][278]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][279]++;
  console.log("Failed to delete event", arguments);
  _$jscoverage['event-creator.js'][280]++;
  event.eventDOM.removeClass("updating");
  _$jscoverage['event-creator.js'][281]++;
  event.eventDOM.removeClass("deleting");
  _$jscoverage['event-creator.js'][282]++;
  event.eventDOM.addClass("error");
  _$jscoverage['event-creator.js'][283]++;
  event.isDeleting = false;
  _$jscoverage['event-creator.js'][284]++;
  return event.isDeleting;
});
  _$jscoverage['event-creator.js'][286]++;
  return (function () {
  _$jscoverage['event-creator.js'][287]++;
  return __func.apply(__this, arguments);
});
})(this));
});
  _$jscoverage['event-creator.js'][291]++;
  return (function () {
  _$jscoverage['event-creator.js'][292]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][295]++;
  removeEditor = (function (__this) {
  _$jscoverage['event-creator.js'][296]++;
  var __func = (function (e) {
  _$jscoverage['event-creator.js'][297]++;
  var eventChanged, text;
  _$jscoverage['event-creator.js'][298]++;
  if (event === $(e == undefined? undefined: e.target).parents(".event").data("event")) {
    _$jscoverage['event-creator.js'][299]++;
    return null;
  }
  _$jscoverage['event-creator.js'][301]++;
  text = $.trim($("textarea", editor).val());
  _$jscoverage['event-creator.js'][302]++;
  if (text === "" && ! event.isDeleting) {
    _$jscoverage['event-creator.js'][303]++;
    deleteEvent();
    _$jscoverage['event-creator.js'][304]++;
    return null;
  }
  _$jscoverage['event-creator.js'][306]++;
  event.eventDOM.appendTo(parent);
  _$jscoverage['event-creator.js'][307]++;
  event.eventDOM.css("top", top);
  _$jscoverage['event-creator.js'][308]++;
  $(".text", event.eventDOM).text(text).show();
  _$jscoverage['event-creator.js'][309]++;
  event.summary = text;
  _$jscoverage['event-creator.js'][310]++;
  editor.remove();
  _$jscoverage['event-creator.js'][311]++;
  delButton.remove();
  _$jscoverage['event-creator.js'][312]++;
  calendarPicker.remove();
  _$jscoverage['event-creator.js'][313]++;
  event.eventDOM.removeClass("editing");
  _$jscoverage['event-creator.js'][314]++;
  this.eventLoader.updateEvent(event);
  _$jscoverage['event-creator.js'][315]++;
  eventChanged = text !== startText || event.calNumber !== startCalNumber;
  _$jscoverage['event-creator.js'][316]++;
  if (eventChanged && ! event.isDeleting) {
    _$jscoverage['event-creator.js'][317]++;
    event.eventDOM.addClass("updating");
    _$jscoverage['event-creator.js'][318]++;
    event.save((function (__this) {
  _$jscoverage['event-creator.js'][319]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][320]++;
  console.log("Updated event", arguments);
  _$jscoverage['event-creator.js'][321]++;
  return event.eventDOM.removeClass("updating");
});
  _$jscoverage['event-creator.js'][323]++;
  return (function () {
  _$jscoverage['event-creator.js'][324]++;
  return __func.apply(__this, arguments);
});
})(this), (function (__this) {
  _$jscoverage['event-creator.js'][327]++;
  var __func = (function (response) {
  _$jscoverage['event-creator.js'][328]++;
  return console.log("Failed update event :(", arguments, event.eventDOM.removeClass("updating"), event.eventDOM.addClass("error"));
});
  _$jscoverage['event-creator.js'][330]++;
  return (function () {
  _$jscoverage['event-creator.js'][331]++;
  return __func.apply(__this, arguments);
});
})(this), startCalNumber);
  }
  else {
    _$jscoverage['event-creator.js'][334]++;
    if (event.isDeleteing) {
      _$jscoverage['event-creator.js'][335]++;
      event.eventDOM.addClass("updating");
    }
  }
  _$jscoverage['event-creator.js'][337]++;
  $("body").unbind("click", removeEditor);
  _$jscoverage['event-creator.js'][338]++;
  return $("#body").unbind("mousewheel", removeEditor);
});
  _$jscoverage['event-creator.js'][340]++;
  return (function () {
  _$jscoverage['event-creator.js'][341]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][344]++;
  $("textarea", editor).keyup((function (e) {
  _$jscoverage['event-creator.js'][345]++;
  if (e.keyCode === 13) {
    _$jscoverage['event-creator.js'][346]++;
    return removeEditor();
  }
  else {
    _$jscoverage['event-creator.js'][347]++;
    if (e.keyCode === 27) {
      _$jscoverage['event-creator.js'][348]++;
      $("textarea", editor).val(startText);
      _$jscoverage['event-creator.js'][349]++;
      event.calNumber = startCalNumber;
      _$jscoverage['event-creator.js'][350]++;
      return removeEditor();
    }
  }
}));
  _$jscoverage['event-creator.js'][353]++;
  $("textarea", editor).keypress((function (e) {
  _$jscoverage['event-creator.js'][354]++;
  if (e.keyCode === 13) {
    _$jscoverage['event-creator.js'][355]++;
    return e.preventDefault();
  }
}));
  _$jscoverage['event-creator.js'][358]++;
  return setTimeout((function () {
  _$jscoverage['event-creator.js'][359]++;
  $(delButton).click((function (e) {
  _$jscoverage['event-creator.js'][360]++;
  deleteEvent();
  _$jscoverage['event-creator.js'][361]++;
  return e.stopPropagation();
}));
  _$jscoverage['event-creator.js'][363]++;
  $("body").click(removeEditor);
  _$jscoverage['event-creator.js'][364]++;
  return $("#body").mousewheel(removeEditor);
}), 0);
});
  _$jscoverage['event-creator.js'][367]++;
  MKT.EventCreator.prototype.getCalendarPicker = (function (event) {
  _$jscoverage['event-creator.js'][368]++;
  var calendarPicker, name, swatches;
  _$jscoverage['event-creator.js'][369]++;
  calendarPicker = $("#templates .calendar-picker").clone();
  _$jscoverage['event-creator.js'][370]++;
  swatches = $(".calendar-swatches", calendarPicker);
  _$jscoverage['event-creator.js'][371]++;
  name = $(".calendar-name", calendarPicker);
  _$jscoverage['event-creator.js'][372]++;
  $.each(this.eventLoader.calendars, (function (__this) {
  _$jscoverage['event-creator.js'][373]++;
  var __func = (function (i, calendar) {
  _$jscoverage['event-creator.js'][374]++;
  var color, do_click, do_hover_off, do_hover_on;
  _$jscoverage['event-creator.js'][375]++;
  if (! calendar.editable) {
    _$jscoverage['event-creator.js'][376]++;
    return null;
  }
  _$jscoverage['event-creator.js'][378]++;
  color = calendar.getColor().getValue();
  _$jscoverage['event-creator.js'][379]++;
  do_hover_on = (function () {
  _$jscoverage['event-creator.js'][380]++;
  return name.text(calendar.getTitle().getText());
});
  _$jscoverage['event-creator.js'][382]++;
  do_hover_off = (function () {
  _$jscoverage['event-creator.js'][383]++;
  return name.text("");
});
  _$jscoverage['event-creator.js'][385]++;
  do_click = (function (__this) {
  _$jscoverage['event-creator.js'][386]++;
  var __func = (function () {
  _$jscoverage['event-creator.js'][387]++;
  return this.changeCalendar(event, i);
});
  _$jscoverage['event-creator.js'][389]++;
  return (function () {
  _$jscoverage['event-creator.js'][390]++;
  return __func.apply(__this, arguments);
});
})(this);
  _$jscoverage['event-creator.js'][393]++;
  return $("#templates .calendar-swatch").clone().css("background-color", this.colourMap[color]).attr("id", "calendar-swatch-" + i).hover(do_hover_on, do_hover_off).click(do_click).appendTo(swatches);
});
  _$jscoverage['event-creator.js'][395]++;
  return (function () {
  _$jscoverage['event-creator.js'][396]++;
  return __func.apply(__this, arguments);
});
})(this));
  _$jscoverage['event-creator.js'][399]++;
  return calendarPicker;
});
  _$jscoverage['event-creator.js'][401]++;
  MKT.EventCreator.prototype.changeCalendar = (function (event, calNumber) {
  _$jscoverage['event-creator.js'][402]++;
  event.calNumber = calNumber;
  _$jscoverage['event-creator.js'][403]++;
  return this.setColour(event, calNumber);
});
  _$jscoverage['event-creator.js'][405]++;
  MKT.EventCreator.prototype.setColour = (function (event, calNumber) {
  _$jscoverage['event-creator.js'][406]++;
  var color;
  _$jscoverage['event-creator.js'][407]++;
  color = this.eventLoader.calendars[calNumber].getColor().getValue();
  _$jscoverage['event-creator.js'][408]++;
  return $(".inner", event.eventDOM).css("background-color", this.colourMap[color]);
});
})();
_$jscoverage['event-creator.js'].source = ["(function(){","  MKT.EventCreator = function(eventLoader, colourMap, config) {","    this.eventLoader = eventLoader;","    this.colourMap = colourMap;","    this.config = config;","    return this;","  };","  MKT.EventCreator.prototype.create = function(event) {","    var eventDOM;","    eventDOM = $(\"#templates .event\").clone();","    eventDOM.data('event', event);","    $(\".text\", eventDOM).text(event.summary);","    eventDOM.width((event.weekLength * 14.2857) + \"%\");","    if (!(event.isStart &amp;&amp; event.isEnd)) {","      eventDOM.addClass(\"multi-week\");","    }","    if (event.isStart) {","      eventDOM.addClass('start');","    }","    if (event.isEnd) {","      eventDOM.addClass('end');","    }","    if (event.summary.endsWith('?')) {","      eventDOM.addClass('tentative');","    }","    if (event.summary.endsWith('!')) {","      eventDOM.addClass('important');","    }","    if (event.isNew) {","      eventDOM.addClass('new');","    }","    event.eventDOM = eventDOM;","    this.setColour(event, event.calNumber);","    if (event.editable) {","      this.makeEditable(event);","    }","    return eventDOM;","  };","  MKT.EventCreator.prototype.makeEditable = function(event) {","    this.makeDraggable(event);","    this.makeResizable(event);","    return event.eventDOM.click((function(__this) {","      var __func = function() {","        return this.click(event);","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this));","  };","  MKT.EventCreator.prototype.makeDraggable = function(event) {","    var do_drag, do_drag_stop, do_start_drag, dragging;","    dragging = {};","    do_start_drag = (function(__this) {","      var __func = function(ev, ui) {","        dragging.start = event.start;","        dragging.end = event.end;","        dragging.day = null;","        return $('#body').mousemove((function(__this) {","          var __func = function(e) {","            dragging.day = $(e.target).parents('.day').add(e.target);","            return dragging.day;","          };","          return (function() {","            return __func.apply(__this, arguments);","          });","        })(this));","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    do_drag = (function(__this) {","      var __func = function() {","        var date, dateString, id, oldEnd, oldStart;","        if (dragging.day) {","          id = dragging.day.attr('id');","          dateString = id.substring(this.config.dayIdPrefix.length);","          date = Date.parseYMD(dateString);","          oldStart = event.start;","          oldEnd = event.end;","          event.start = date;","          event.end = date.addDays(event.length);","          if (event.start - oldStart !== 0 || event.end - oldEnd !== 0) {","            return this.eventLoader.updateEvent(event, oldStart, oldEnd);","          }","        }","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    do_drag_stop = (function(__this) {","      var __func = function() {","        $('#body').unbind('mousemove');","        if (event.start - dragging.start !== 0 || event.end - dragging.end !== 0) {","          event.eventDOM.addClass('updating');","          return event.save((function(__this) {","            var __func = function() {","              console.log('Moved event', arguments);","              return event.eventDOM.removeClass('updating');","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this), (function(__this) {","            var __func = function() {","              return console.log('Failed to move event :(', arguments, event.eventDOM.removeClass('updating'), event.eventDOM.addClass('error'));","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this));","        }","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    return event.eventDOM.draggable({","      revert: true,","      distance: 10,","      helper: function() {","        return $('&lt;div&gt;');","      },","      scroll: false,","      cursor: 'move',","      handle: $('.text', event.eventDOM),","      start: do_start_drag,","      drag: do_drag,","      stop: do_drag_stop","    });","  };","  MKT.EventCreator.prototype.makeResizable = function(event) {","    var do_resize, do_resize_start, do_resize_stop, handles, resizing;","    resizing = {};","    handles = [];","    if (event.isStart) {","      handles.push('w');","    }","    if (event.isEnd) {","      handles.push('e');","    }","    do_resize_start = (function(__this) {","      var __func = function(e, ui) {","        resizing.direction = (e.pageX &lt; (ui.originalPosition.left + (ui.originalSize.width / 2))) ? 'start' : 'end';","        resizing.x = e.pageX;","        resizing.y = e.pageY;","        resizing.start = event.start;","        resizing.end = event.end;","        resizing.day = null;","        return $('#body').mousemove((function(__this) {","          var __func = function(e) {","            resizing.day = $(e.target).parents('.day').add(e.target);","            return resizing.day;","          };","          return (function() {","            return __func.apply(__this, arguments);","          });","        })(this));","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    do_resize = (function(__this) {","      var __func = function(e, ui) {","        var date, dateString, id, oldEnd, oldStart;","        if (resizing.day) {","          id = resizing.day.attr('id');","          dateString = id.substring(this.config.dayIdPrefix.length);","          date = Date.parseYMD(dateString);","          oldStart = event.start;","          oldEnd = event.end;","          if (resizing.direction === 'start') {","            event.start = date &lt; resizing.end ? date : resizing.end.addDays(-1);","          } else if (resizing.direction === 'end') {","            event.end = date &gt; resizing.start ? date.addDays(1) : resizing.start.addDays(1);","          }","          event.length = Math.round((event.end - event.start) / (1000 * 60 * 60 * 24));","          if (event.start - oldStart !== 0 || event.end - oldEnd !== 0) {","            return this.eventLoader.updateEvent(event, oldStart, oldEnd);","          }","        }","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    do_resize_stop = (function(__this) {","      var __func = function(e, ui) {","        $('#body').unbind('mousemove');","        event.eventDOM.remove();","        this.eventLoader.updateEvent(event);","        event.eventDOM.addClass('updating');","        if (event.start - resizing.start !== 0 || event.end - resizing.end !== 0) {","          return event.save((function(__this) {","            var __func = function() {","              console.log('Resized event', arguments);","              return event.eventDOM.removeClass('updating');","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this), (function(__this) {","            var __func = function() {","              return console.log('Failed to resize event :(', arguments, event.eventDOM.removeClass('updating'), event.eventDOM.addClass('error'));","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this));","        }","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    if (event.isStart || event.isEnd) {","      return event.eventDOM.resizable({","        handles: handles.join(', '),","        ghost: true,","        start: do_resize_start,","        resize: do_resize,","        stop: do_resize_stop","      });","    }","  };","  MKT.EventCreator.prototype.click = function(event) {","    var calendarPicker, delButton, deleteEvent, editor, parent, removeEditor, startCalNumber, startText, top;","    if (event.eventDOM.hasClass('editing')) {","      return null;","    }","    editor = $('#templates .editor').clone();","    delButton = $('#templates .delete').clone();","    calendarPicker = this.getCalendarPicker(event);","    startText = $('.text', event.eventDOM).text();","    startCalNumber = event.calNumber;","    $('textarea', editor).text(event.isNew ? 'New event...' : startText);","    $('textarea', editor).height($('.text', event.eventDOM).height());","    $('textarea', editor).keyup(function() {","      var height, text;","      text = $('textarea', editor).val();","      $(\"#layout-event\").width((event.weekLength * 14.2857) + \"%\");","      height = $(\"#layout-event .text\").text(text).outerHeight();","      $('textarea', editor).height(height);","      return event.eventDOM.css('border', 'none');","    }).keyup();","    parent = event.eventDOM.parent();","    top = event.eventDOM.css('top');","    event.eventDOM.css({","      top: event.eventDOM.offset().top,","      left: event.eventDOM.offset().left","    });","    event.eventDOM.appendTo($('body'));","    $('.text', event.eventDOM).hide();","    $('.inner', event.eventDOM).append(editor);","    delButton.appendTo(event.eventDOM).hide().fadeIn();","    calendarPicker.appendTo(event.eventDOM).hide().fadeIn();","    $('textarea', editor).focus().select();","    event.eventDOM.addClass('editing');","    event.eventDOM.removeClass('error');","    deleteEvent = (function(__this) {","      var __func = function() {","        event.isDeleting = true;","        removeEditor();","        event.eventDOM.addClass('updating');","        event.eventDOM.addClass('deleting');","        return event.remove((function(__this) {","          var __func = function() {","            console.log('Deleted event', arguments);","            return event.eventDOM.remove();","          };","          return (function() {","            return __func.apply(__this, arguments);","          });","        })(this), (function(__this) {","          var __func = function() {","            console.log('Failed to delete event', arguments);","            event.eventDOM.removeClass('updating');","            event.eventDOM.removeClass('deleting');","            event.eventDOM.addClass('error');","            event.isDeleting = false;","            return event.isDeleting;","          };","          return (function() {","            return __func.apply(__this, arguments);","          });","        })(this));","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    removeEditor = (function(__this) {","      var __func = function(e) {","        var eventChanged, text;","        if (event === ($(e == undefined ? undefined : e.target).parents('.event').data('event'))) {","          return null;","        }","        text = $.trim($('textarea', editor).val());","        if (text === '' &amp;&amp; !event.isDeleting) {","          deleteEvent();","          return null;","        }","        event.eventDOM.appendTo(parent);","        event.eventDOM.css('top', top);","        $('.text', event.eventDOM).text(text).show();","        event.summary = text;","        editor.remove();","        delButton.remove();","        calendarPicker.remove();","        event.eventDOM.removeClass('editing');","        this.eventLoader.updateEvent(event);","        eventChanged = text !== startText || event.calNumber !== startCalNumber;","        if (eventChanged &amp;&amp; !event.isDeleting) {","          event.eventDOM.addClass('updating');","          event.save((function(__this) {","            var __func = function() {","              console.log('Updated event', arguments);","              return event.eventDOM.removeClass('updating');","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this), (function(__this) {","            var __func = function(response) {","              return console.log('Failed update event :(', arguments, event.eventDOM.removeClass('updating'), event.eventDOM.addClass('error'));","            };","            return (function() {","              return __func.apply(__this, arguments);","            });","          })(this), startCalNumber);","        } else if (event.isDeleteing) {","          event.eventDOM.addClass('updating');","        }","        $('body').unbind('click', removeEditor);","        return $(\"#body\").unbind('mousewheel', removeEditor);","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this);","    $('textarea', editor).keyup(function(e) {","      if (e.keyCode === 13) {","        return removeEditor();","      } else if (e.keyCode === 27) {","        $('textarea', editor).val(startText);","        event.calNumber = startCalNumber;","        return removeEditor();","      }","    });","    $('textarea', editor).keypress(function(e) {","      if (e.keyCode === 13) {","        return e.preventDefault();","      }","    });","    return setTimeout(function() {","      $(delButton).click(function(e) {","        deleteEvent();","        return e.stopPropagation();","      });","      $('body').click(removeEditor);","      return $('#body').mousewheel(removeEditor);","    }, 0);","  };","  MKT.EventCreator.prototype.getCalendarPicker = function(event) {","    var calendarPicker, name, swatches;","    calendarPicker = $('#templates .calendar-picker').clone();","    swatches = $('.calendar-swatches', calendarPicker);","    name = $('.calendar-name', calendarPicker);","    $.each(this.eventLoader.calendars, (function(__this) {","      var __func = function(i, calendar) {","        var color, do_click, do_hover_off, do_hover_on;","        if (!(calendar.editable)) {","          return null;","        }","        color = calendar.getColor().getValue();","        do_hover_on = function() {","          return name.text(calendar.getTitle().getText());","        };","        do_hover_off = function() {","          return name.text('');","        };","        do_click = (function(__this) {","          var __func = function() {","            return this.changeCalendar(event, i);","          };","          return (function() {","            return __func.apply(__this, arguments);","          });","        })(this);","        return $('#templates .calendar-swatch').clone().css('background-color', this.colourMap[color]).attr('id', 'calendar-swatch-' + i).hover(do_hover_on, do_hover_off).click(do_click).appendTo(swatches);","      };","      return (function() {","        return __func.apply(__this, arguments);","      });","    })(this));","    return calendarPicker;","  };","  MKT.EventCreator.prototype.changeCalendar = function(event, calNumber) {","    event.calNumber = calNumber;","    return this.setColour(event, calNumber);","  };","  MKT.EventCreator.prototype.setColour = function(event, calNumber) {","    var color;","    color = this.eventLoader.calendars[calNumber].getColor().getValue();","    return $('.inner', event.eventDOM).css('background-color', this.colourMap[color]);","  };","","})();"];
